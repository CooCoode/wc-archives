<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数学奇才攻陷 DeFi 平台 - SeeDAO WeChat Archive</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.5.10/dist/typography.min.css" rel="stylesheet">
    <style>
        /* Custom styles */
        .article-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .article-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
        }
        .article-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #333;
            line-height: 1.4;
        }
        .article-meta {
            margin-top: 1rem;
            color: #666;
            font-size: 0.9rem;
        }
        .article-digest {
            font-size: 1.1rem;
            color: #555;
            line-height: 1.6;
            margin: 1.5rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 6px;
        }
        .article-categories {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
        }
        .category-tag {
            padding: 0.25rem 0.75rem;
            background: #e9ecef;
            color: #495057;
            border-radius: 9999px;
            font-size: 0.875rem;
        }
        .wechat-notice {
            text-align: center;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 2rem 0;
        }
        .wechat-button {
            display: inline-block;
            margin-top: 1rem;
            padding: 0.75rem 1.5rem;
            background: #07C160;
            color: white;
            border-radius: 6px;
            text-decoration: none;
            transition: background-color 0.2s;
        }
        .wechat-button:hover {
            background: #06B057;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="article-container">
        <nav class="mb-8">
            <a href="../../index.html" class="text-blue-600 hover:text-blue-800">← Back to Archive</a>
        </nav>

        <header class="article-header">
            <h1 class="article-title">数学奇才攻陷 DeFi 平台</h1>
            <div class="article-meta">
                <span class="mr-4">作者: 翻译公会tanghul</span>
                <time>发布时间: 2022-09-26 15:09:27</time>
            </div>
        </header>

        <div class="article-digest">
            18 岁少年攻击DeFi 交易平台 Indexed 的事件始末
        </div>

        <div class="mb-8">
            <img src="images/cover.jpg" alt="Article cover" class="w-full h-auto rounded-lg">
        </div>

        <article class="article-content prose prose-lg mx-auto">
            <section style="font-size: 15px; letter-spacing: 0px; line-height: 1.9; padding-right: 3px; padding-left: 3px; box-sizing: border-box; visibility: visible; opacity: 1;"><section style="text-align: center; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><section style="max-width: 100%; vertical-align: middle; display: inline-block; line-height: 0; box-sizing: border-box; visibility: visible; opacity: 1;"><img class="rich_pages wxw-img" style="vertical-align: middle; width: 100%; box-sizing: border-box; visibility: visible; opacity: 1;" src="images/content_1.jpg"></section></section><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">时间是 10 月 14 日。地点位于英格兰利兹附近的一间房子。手机响起的时候，劳伦斯 • 戴正坐在沙发上享用炸鱼薯条晚餐。短信来自他在 Indexed Finance 的一位同事。这是个加密货币平台，用来创建可以代表其它若干币种的代币，相当于一个指数基金，只不过是在区块链上。这位同事发来的是一张最近交易记录的截图，后面跟着个问号。「要是不理解这东西，你可能会说＇这笔交易可真不赖＇。」戴说。但是他是个行家，这张图足以让他警觉：一位用户以极低的价格大量买入某些代币，这本来是不可能的。出大事了。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">戴跳了起来，把食物碰翻了一地，跑进卧室给 Indexed 的创始人之一狄龙 • 凯勒打电话。6 个时区之外，奥斯汀附近。凯勒正坐母亲家的客厅里拆一台 DVD 播放机，试图拯救里面的一个激光头。他拿起电话，听到戴上气不接下气地解释说平台受到了攻击。凯勒回忆道：「我只说了一句，＇什么?＇」</p><section style="text-align: center; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><section style="max-width: 100%; vertical-align: middle; display: inline-block; line-height: 0; border-style: dashed; border-width: 8px; border-color: rgb(17, 68, 41); box-sizing: border-box; visibility: visible; opacity: 1;"><img class="rich_pages wxw-img" style="vertical-align: middle; width: 100%; box-sizing: border-box; visibility: visible; opacity: 1;" src="images/content_2.jpg"></section></section><section style="color: rgb(17, 68, 41); box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;">戴　摄影师：彭博商业周刊 Joanne Coates</p></section><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">他们拿出笔记本电脑，一头扎进平台代码里。几位熟悉的朋友也赶来帮忙，戴的猫咪芬尼（以比特币先驱哈尔 • 芬尼的名字命名）爬上了他的肩头以示支持。Indexed 建立在以太坊上，这是个记录着交易细节的公共账簿，它意味着攻击记录也在上面。准确搞清楚到底发生了什么得花上几周时间，但明摆着的是，平台被耍了，以至于用户手里的代币价值被严重低估，以极低的折扣卖给了攻击者。加在一起，肇事者总共带着价值 1600 万美元的资产逃之夭夭。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">凯勒和戴止住了损失，修复了代码来防止进一步攻击，随后开始面对公关噩梦。平台的 Discord 和 Telegram 频道里，代币持有者们浮想联翩、骂声不绝，有的则怪罪团队、索要赔偿。凯勒在 Twitter 上向 Indexed 的数百名用户道歉，为他未能发现漏洞承担责任。他写道：「我算是搞砸了。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">现在的问题是谁发动了攻击，以及他们是否会归还资金。大多数情况下，利用加密平台漏洞进行攻击都被认为是内部所为，除非能证明另有其人。「在默认情况下，人们总是会问，＇谁干的？为什么开发团队要这么做？＇」戴说道。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">攻击发生后的第二天早上，戴正试着睡一会儿，突然意识到有个贡献者有一阵子没动静了。几周前，一个用户名叫 UmbralUpsilon（匿名在加密社区是一种标准做法）的程序员在 Discord 上联系了戴和凯勒，说要搞出个能让平台更高效的 bot 机器人。他们同意了，还发过去一笔启动费用。凯勒说：「当时我们希望他或许能成为一个固定贡献者来着。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">考虑到他们讨论的内容范围，戴本以为攻击发生之后 UmbralUpsilon 会帮他们一把，或者至少表示同情。但是，什么都没有。戴调出了他们的聊天记录，发现只有他那部分对话还在，UmbralUpsilon 已经删掉了自己的信息，而且还改掉了用户名。「这让我一骨碌就下了床，」戴说。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">他把自己的怀疑告诉了团队。接下来的几天里，他们在网络上仔细搜寻攻击者的数字踪迹。他们发现，攻击中用于转移代币的以太坊钱包，与最近一场黑客比赛中某个参赛者用来收取奖金的钱包有关联，而这名参赛者有时自称 UmbralUpsilon。他们调出此人的注册信息，看到它链接到合作编码平台 GitHub 上的一份个人档案。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">创建这份 GitHub 档案的人使用的是以＂amedjedo＂开头的电子邮件地址，域名则属于安大略省一所公立学校的董事会。戴和同事还发现，一个维基百科编辑的用户名和 Github 上的这个人很接近。这位编辑曾修改过加拿大一项颇受欢迎的高中生智力竞赛的页面，在＂校友＂一栏中添加了一个名字：＂Andean Medjedovic，著名数学家＂。剩下的活儿就交给谷歌了。直到最近，Medjedovic 还是安大略省滑铁卢大学的一名硕士研究生，就读于数学专业。简历显示他对加密货币感兴趣。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">整个团队松了一口气。通常，网络攻击者的身份一旦被确认，会归还资金换取一笔保全颜面的赏金，再获得个＂白帽黑客＂的荣誉。戴与 UmbralUpsilon 联系，提出只要他安全归还代币，就可以获得 10% 的奖励。戴还心不甘情不愿地称赞了句「干得好」，但他没有得到回复。然后，凯勒尝试了另一个策略，他给 Medjedovic 发信息，直呼其名＂Andean＂。这一次 Medjedovic 有了反应。他在 Twitter 上公开嘲讽 Indexed 的用户：「你们被场外交易骗了。你们对此无能为力……这就是加密货币。」还有一名团队成员给 Medjedovic 单独发邮件说，如果退回代币将付给他 5 万美元。Medjedovic 回了个以太坊地址链接，并留言：「把钱转过来。」他们没有上当。令人震惊的是，他们发现这个带来许多折磨的人还只有 18 岁。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">最后，在不得不请出律师和警察之前，凯勒给 Medjedovic 发了条短信做最后一次恳求。他写道：「恳求你现在放弃，让自己好过一点。」这名少年的回复是「Xdxdxd」(表示狂笑的表情符号)，外加一句，「祝你好运。」</p><section style="text-align: center; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><section style="max-width: 100%; vertical-align: middle; display: inline-block; line-height: 0; border-width: 8px; border-style: dashed; border-color: rgb(17, 68, 41); box-sizing: border-box; visibility: visible; opacity: 1;"><img class="rich_pages wxw-img" style="vertical-align: middle; width: 100%; box-sizing: border-box; visibility: visible; opacity: 1;" src="images/content_3.jpg"></section></section><section style="color: rgb(17, 68, 41); box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;">凯勒　摄影师：彭博商业周刊 Cindy Elizabeth</p></section><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">当初创建 Indexed 时，凯勒和联合创始人把它设想成 DeFi 的进步。基于区块链的 DeFi &nbsp;运动（去中心化金融），旨在为借贷、资产交易和投资组合管理提供一种更自动化、更少中介的运作方式。一些支持者对 DeFi 持有实用主义观点，认为它是对传统金融的改进，省去了那些抽取费用的中间商和行动迟缓的人工决策。另一些人则更加自由主义，认为 DeFi 是现有体制之外的一处桃源，是规避政府或大型公司强加的规则和限制的一个渠道。此外还有一些怀疑论者，他们认为这一切都是骗局。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">自称「很进步」的凯勒完全属于实用主义阵营。23 岁时，他觉得计算机科学课程没有教给他任何新东西，于是从德克萨斯大学达拉斯分校辍学。凯勒随后创办了 Indexed 平台，试图解决一个问题：如果一个人想交易加密货币，但又觉得每天管理投资组合很麻烦，该怎么办？</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">在传统金融领域，如果投资者想平衡持有多种股票，可以通过购买指数基金将买卖股票的日常工作交给投资组合经理去做。凯勒着手在区块链上创建一个类似的机制，但是由算法来驱动交易。指数基金经理会维护一个由指数类股票的标的资产构成的投资组合，而 Indexed 的算法则为每个指数代币维护一个标的代币构成的「资产池」。用户可以将一种或所有标的资产注入池中，以换取一个指数代币——这个过程被称为「铸币」。同样，用户也可以通过将指数代币注入池中来「销毁」它，以换取一种或所有标的资产。另外，就像指数股票型基金（ETF）一样，用户可以在 Uniswap 等去中心化交易所买卖指数代币。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">指数基金的形式多种多样，每一种都使用不同的投资策略。有些指数是市值加权指数，比如标准普尔 500 指数：如果该指数内的某只股票价格上涨，则该股票在投资组合中的价值占比也会相应上升。另一些指数基金，则寻求保持各支股票间的固定占比。例如，如果你想让微软的股票一直占投资组合的 20%，那么当微软股票的价格上涨了，投资组合经理就会卖出一些，以保持其 20% 的权重。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">凯勒和他的团队以这类基金为模型塑造 Indexed，使用一种称为「自动做市商(AMM)」的机制来维持标的资产之间平衡占比，许多 DeFi 平台都是这么做的。与传统做市商不同，AMM 本身不会买卖资产。相反，它通过调整内部代币的「池内价格」，来激励交易者从池中购买代币，或将代币卖入池中，以此帮助资产池达到预期的资产平衡。当池中需要更多的某种代币时，其「池内价格」就会上涨；当资产池对某种代币的需求减少时，其「池内价格」就会下降。这个模型假设用户会理性地与协议互动，低买高卖。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">通过消灭人工管理者，Indexed 得以免收管理费。而 indexed 的劲敌 Index Coop 的用户来说，仅仅持有其最受欢迎的指数代币就得支付 0.95% 的管理费。（Indexed 对销毁代币，以及在池中交换资产收取手续费，但这些只影响到一小部分用户）。Indexed 还通过限制平台与外部实体之间的交互次数来节省成本。例如，当 Indexed 需要计算某个资产池内所有资产的总值时，它有时会根据池中权重最大的代币（称为「基准代币」）的权重和价值进行推断，而不是到 Uniswap 等交易所去一一检查每种代币的价格。通过这种方式，Indexed 减少了在以太坊上支付的交易费用。凯勒将「完全消极」视为「指数基金现有运作方式的自然延伸」。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">但「消极」也带来了风险。如果代码有问题，有人就可以直接利用它，而不需要绕过任何人为保护措施。而限制区块链交互来降低成本的做法则需要权衡：智能合约（一种当某些条件满足时能自动执行的程序脚本）的步骤越少，给安全漏洞留下的空间就越大。被攻击过的加密货币平台列表很长，并且每周都在增加：Poly Network, Wormhole, Cream Finance, Rari Capital …… 戴说：「DeFi 领域有句老话，有两种 DeFi 协议：已经被黑的和即将被黑的。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">凯勒早就意识到有一种可能的攻击途径：Indexed 用来向资产池中导入代币的机制。当发生这种「索引重建」的情况──比如说，某种代币的市场价值超过另一种代币，进而有资格被纳入蓝筹基金──之后，资产池会用一个复杂的方程来设定这种新代币的初始价格。该方程中有一个变量是基准代币的价值。如果你能以某种方式搞乱基准代币在资产池内的定价，理论上就可以迫使资产池对其它代币给出错误的定价。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">凯勒说：「我曾花了至少两周时间来研究这个问题。」但他没能找到任何错误。他雇来检查代码的两位安全研究人员也没有找到错误。所以他说，「我于是确定它不是一个攻击载体。」不过，Indexed 还是在网站上发布了一条警告：「我们对合约的安全性有信心……（但）我们不能绝对确信没有被忽视的错误。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">该平台于 2020 年 12 月首次亮相，最初提供两个指数代币：CC10 和 DEFI5。其中 CC10 代表以太坊上市值最高的 10 个代币，DEFI5 代表市值最高的 5 个 DeFi 代币。这个项目很快就获得了一小群忠实粉丝，这其中就包括戴。戴拥有理论计算机科学博士学位和金融工程硕士学位，他的硕士毕业论文就是关于股票市场指数投资组合优化。Indexed 与他的兴趣相一致，也与他相对较低的风险偏好相匹配。他说：「当谈到加密货币以外的投资时，我完全是一个无趣的人。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">戴和凯勒相处得很好。他们都有一种极具网络搞怪风格的幽默感，而且一位是有写作天赋的金融专家，另一位是富有创造力的程序员，各自的技能互补。「我完全是个文科生，而狄龙 是标准的理工男。」现年 33 岁的戴说。2021 年 4 月，戴辞去在一家石油和天然气公司的工作并全职加入了 Indexed 。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">那一年，人们对加密货币兴趣激增。在这股力量的推动下，Indexed 一飞冲天，很快成为以太坊上市值第二大的指数协议，仅次于 index Coop。他们提高了自己的志向，推出指数代币，并计划进行升级，让存在池中的资产能够赚取利息。Indexed 部署其代码的 DeFi 平台 Balancer 也备受鼓舞，给他们提供了一笔资助——这是对 Indexed 的未来投下的信任票。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">当 Indexed 上线时，小名 Andy 的 Medjedovic 刚刚开始攻读硕士学位。他计划在一年内读完硕士。他做事一向很快，还在小学时就已经开始上 10 年级的数学课，14 岁就从高中毕业，并在滑铁卢大学用三年时间完成了本科学业。滑铁卢大学是加拿大数学和计算机科学的顶级学校之一，也是以太坊联合创始人 Vitalik Buterin 的母校。到 2021 年秋天，Medjedovic 已经提交了关于随机矩阵理论的硕士论文，并计划申请博士学位。滑铁卢大学数学教授 David Jao 说：「我想不出那时候还有哪个学生能这么早拿到这个学位。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">尽管在学术上很领先，但 Medjedovic 的社会成熟度却落后了。他的一位要求匿名以便坦率谈论敏感问题的前同学回忆说，他「自信到了傲慢的地步」，公开看不起那些他觉得没他聪明的学生。这位同学还说，「无论他做了什么或说了什么，他都相信是不会有错的，是绝对的真理。」 据说，Medjedovic 与一些极端主义思想眉来眼去：该同学曾听到他对白人至上主义和人种改良学赞赏有加（本文发表前，Medjedovic 没有回应对此发表评论的要求。）</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">尽管如此，Medjedovic 还是交到了一些朋友，并通过国际象棋和电子游戏《英雄联盟》等活动与他们保持联系。他还喜欢读小说，尤其是科幻小说。在一个社交网络上的个人资料中，他引用了 Kurt Vonnegut 的《猫的摇篮》中的几段话，表达的是人类探寻知识的徒劳：「老虎要捕猎，鸟儿要飞翔，人要坐下来想啊，想啊，想；老虎要睡觉，鸟儿要归巢，人要对自己说这一切属他最明膫。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">Medjedovic 也逐渐成为一名熟练的程序员，经常参加一个名为 Code4rena（简称 C4）的在线黑客竞赛。在这个竞赛中，公司悬赏让开发人员寻找自己系统中的安全漏洞。他曾两次在比赛中获奖。「他似乎很友好，也很酷，」协助运营 C4，并在 Indexed 遭受攻击前后都与 Medjedovic 有过通信联系的 Adam Avenir 说：「像一个认真的孩子。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">Medjedovic 对 DeFi 感兴趣，尤其是 AMM 机制。他在一封电子邮件中说：「每当我听说一种新型 DeFi 产品，就会仔细研究它的运作方式。如果我想出一个好主意，就会投点钱进去。」（Medjedovic 拒绝接受电话采访，但是同意通过电子邮件回答一些问题。）他估计自己花了数百个小时「把玩这些 DeFi 产品背后的数学，试验不同策略的盈利能力。」然后，他编写出能在这些平台上执行套利交易的 bot 机器人，赚取少量利润，并帮助资产池更高效地运行。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">在一个论坛上看到 Indexed 后，他仔细研究了它的智能合约，并注意到 Indexed 的代码中有一个进行「错误定价的机会」——正是凯勒曾经担心过的，那种在引入新代币时可以扭曲资产池内部价格计算的手段。他还发现，有可能绕过限制池内某些交易规模的保护措施。他说：「起初，我并不相信，」他进行了几次计算，「理论上是可行的。」接下来的一个月，他写了一个能利用这个漏洞的脚本程序。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">他还在 Discord 上以 UmbralUpsilon 的身份联系了 Indexed 团队，询问了一些有关资产组合和定价的基本问题，并提出为平台编写套利机器人。现在回想起来，戴说：「我怀疑他可能是想旁敲侧击，看看我是否能为他打开一个缺口。」凯勒和戴说，他们当时分享的信息没有在这次攻击中被利用。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">最终，在10月中旬，Medjedovic 准备好了要部署的代码。同样重要的是，此时对于 Indexed 中最大的两个资产池进行「索引重建」的时机已经成熟。它们需要的只是某个用户引入少量的新代币——对这两个资产池来说，需要的都是 Sushi，DeFi 交易所 SushiSwap 的代币）。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">利用这个漏洞需要编写数百条程序指令，法庭后来用了几十页的文件来解释。但这个过程包含几个关键的步骤。为了攻击构成 DEFI5 指数的代币池（以及后来的 CC10 池），Medjedovic 编写了一个程序，并用这个程序获得了价值 1.57 亿美元的「闪电贷」——这是加密货币交易中的一种机制，只要用户在同一组预先编程的交易中偿还贷款，就可以获得资金。然后，他的脚本用一大部分贷款买走池中几乎所有的 UNI（DeFi 交易所 Uniswap 的代币）。UNI 的突然供应不足导致池内的 UNI 价格飙升，因为算法试图激励交易者将更多的 UNI 卖回池中，并且不再从池中购买 UNI，这是为了恢复池内原来的平衡。Medjedovic 买的 UNI 越多，池内 UNI 的价格就涨得越高，最终达到了外部市场价格的 860 倍。他总共花费了价值 1.09 亿美元的代币，买下了实际价值 520 万美元的 UNI。</p><section style="margin-top: 10px; margin-bottom: 10px; text-align: left; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><section style="display: inline-block; vertical-align: top; box-sizing: border-box; visibility: visible; opacity: 1;"><section style="line-height: 1em; padding-left: 2px; padding-right: 2px; font-size: 18px; color: rgb(27, 92, 57); box-sizing: border-box; visibility: visible; opacity: 1;"><p style="box-sizing: border-box; visibility: visible; opacity: 1;"><strong style="box-sizing: border-box; visibility: visible; opacity: 1;">对 DEFI5 的攻击：1 个程序和 7 个关键步骤（节选）</strong></p></section></section></section><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">从表面上看，这是一笔疯狂的交易，但 UNI 在 DEFI5 资产池中扮演了一个独特的角色。UNI 是基准代币——池子用它来推断其总值。随着池中 UNI 的数量急剧减少，资产池现在对其自身的估值只相当于真实价值的 380 分之 1。因此，需要新引入的 Sushi 数量也急剧减少，这可是铸造 DEFI5 代币离不开的。此时，只要 Medjedovic 愿意，他就可以用价值 3200 美元的 Sushi 代币换取价值 117.2 万美元的 DEFI5 代币。而如果他干脆就这么干的话，Indexed 反而不会出什么问题。Indexed 协议对用户可以交换到池中的新代币数量进行了限制，因此他只能提取大约池子价值的 1.5%——考虑到交易手续费，这对他来说算不上有利可图。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">相反，Medjedovic 的脚本拿到了另一笔闪电贷──价值 240 万美元的 Sushi 代币。他没有把这些代币换进资产池中，而是把它们赠送给了资产池——看似不合逻辑，却是 Indexed 的算法从设计上就没有考虑到的一个举动。这笔「赠送」打垮了资产池，绕过了它对新代币的常规交易限制。它让 Medjed ovic 可以自由地将被高估的 Sushi 代币兑换成被低估的 DEFI5 代币，然后又套现为池中的标的资产，以此偿还贷款，剩下的落入腰包，如今价值 1190 万美元。对 CC10 资金池的攻击更是让总值提高到了 1600 万美元。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">Medjedovic 在电子邮件中回忆说，他对这次攻击的成功感到惊讶。他写道：「我只做了几次尝试就搞定了，」很快他就没钱支付区块链的交易费用了。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">「绝对令人印象深刻，」凯勒说，「但是他的才能用错了地方。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">如果 Medjedovic 曾考虑过归还代币，那他也没有考虑太久。在 Indexed 团队确认他的身份后，他在 Twitter 上发布了一首挑衅的诗：「一只青蛙跃入池，耍酷全凭有本事。｜ 为把蛙儿煮了吃，他们拼命做尝试。＇不要套利那些钱＇，他们哭声响彻天。｜但是青蛙喜洋洋，皆因神灵在身旁。」有人留言拱火。有人发了个皇冠表情。还一个人写道：「我爱这家伙。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">一些人对他使用了种族主义的语言和修辞厉声斥责：Medjedovic 用于这次攻击的以太坊地址包括数字「1488」(一个新纳粹口号的缩写），他还把辱骂黑人的「黑X」一词写到代码里，16 次。一位推特用户称他为「Balancer 资产池的 Dylan [sic] Roof」，这是指 2015 年在南卡罗来纳州查尔斯顿一座教堂枪杀 9 名黑人的凶手。Medjedovic 点赞了这条推文。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">攻击发生后的几周对凯勒和戴来说如同地狱。他们忙着重建协议，应付网上的质疑，并为他们的代币持有者设计一个赔偿方案。祸不单行，就连戴的猫咪芬尼也没有逃过残酷的命运，它被一辆汽车撞死了。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">12 月 9 日，攻击发生近两个月后 ，凯勒和戴在安大略省对 Medjedovic 提起诉讼。他们认为他的行为构成欺诈，他应该把代币归还给原来的所有者。结果他们并不是第一个这样做的人。一家注册在特拉华州的匿名公司 Cicada 137 LLC 曾经起诉过 Medjedovic，但该案件已经封存。直到提交了自己的诉讼请求后，凯勒和戴才知道这件事。根据其诉讼内容，Cicada 137 是那次黑客攻击中损失代币最多的持币者，涉案代币总值在当时达到了 900 万美元 。（Cicada 137 的律师 Benjamin Bathgate 拒绝透露客户的身份）</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">当凯勒和戴向法庭提起诉讼时，Cicada 已经获得了这些争议代币的冻结令。法院实际上无法控制 Medjedovic 的钱包，但如果他现在动用这些代币，就会触犯法律。Cicada 还得到了Medjedovic 父母房子的搜查令，Medjedovic 曾一直住在那里。但当 12 月 6 日法院执行搜查时，他已经带着电脑设备离开了。他的父母和弟弟都说不知道他在哪里。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">凯勒和戴的律师在诉讼中提出，攻击中的两个特定步骤违反市场操纵和电脑黑客法规。其中一个是将 DEFI5 池中的几乎所有 UNI 代币买走，这一似乎无理性的交易的合理解释在于，它扭曲了定价，致使算法强制 Indexed 用户卖出代币，让 Medjedovic 能够以低价买入。「该交易操作的唯一目的，是误导代币持有者以他们永远不会同意的条件卖掉代币，」代表凯勒与戴的律师 Stephen Aylward 说，「我们认为这是一种市场操纵。」同样的论点也适用于 Medjedovic 对 CC10 资产池所做的操作。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">另一个非法交易步骤是 Medjedovic 通过赠送 Sushi 击溃资产池，从而欺骗了算法，使他能绕过针对某些交易的规模限制。Aylward 称这是「Andean 为使安全措施失效而实施的故意行为，就和破坏银行安全系统一样。」他认为，这该行为符合加拿大对「极为宽泛」的黑客行为的法律定义，可以被解释为「颠覆计算机系统的预期目的」。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">Medjedovic 尚未正式回应这两起诉讼，他告诉我他在安大略省甚至连律师都没有。但在我们的电子邮件交流中，他声称自己执行了一系列完全合法的交易。他所做的一切都没有「涉及进入一个我不被允许进入的系统。」他说：「我没有偷窃任何人的私钥。我与智能合约的交互符合这些智能合约自身公开的规则。在这场交易中失去互联网代币的，是那些试图利用智能合约为自己谋利的人，而且这些人显然没有完全理解持有这些交易头寸所面临的风险。」Medjedovic 补充说，他在执行这一策略时承担了「巨大的风险」。如果失败，他将失去「我投资组合中的一大部分。」(他可能损失 3 ETH 的交易费用，当时价值大约 11000 美元）。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">此案提出了一些棘手的问题，都是关于「人与区块链代码的哪些交互方式能够为法律所允许」。例如，原告声称 Medjedovic 操纵资产池内代币价值的行为，等同于他作出了「虚假陈述」。但作出虚假陈述的究竟是 Medjedovic 还是算法？多伦多专攻信息技术领域的律师 Barry Sookman 说，这没有本质的区别：「个人要对其控制下的技术活动负责。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">如果 Medjedovic 参与了欺骗，那么他欺骗了谁？正是基于这一点，为 Medjedovic 提供咨询，但没有正式参与安大略省案件的达拉斯律师 Andrew Lin 拒绝接受虚假陈述的说法。Andrew Lin 说：“很难说他对谁做了虚假陈述，他写出了几行代码。代码本身是没有对错之分的。“</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">研究网络安全的 Andrea Matwyshyn 说，如果不了解案件调查过程中可能发现的所有事实，就无法预测法官将做出怎样的判决。他是宾夕法尼亚州立大学的法律与工程教授。但这个案子极不明朗，尤其是考虑到 Medjedovic 关于他承担了风险的说法。「华尔街的人一旦发现哪儿有漏洞，就会展开战略研究，往往能一下子赚到很多钱。」Matwyshyn 说道，「我可以想象，在调查了本案的技术和财务细节，并权衡各种因素后，法官会得出结论：有一些因素使本案中的这种行为更像是高度投机交易。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">DeFi 所处的法律和监管的灰色地带也增加了不确定性。任何拥有专业技术知识的人都可以去创建一个投资工具，把它放上网，让用户暴露在可能被攻击的风险中。美国证券交易委员会主席 Gary Gensler 曾表示，他计划将加密货币交易平台纳入管理。而前商品期货交易委员会委员、现任 SEC 总法律顾问 Dan Berkovitz 称，DeFi 是一个「霍布斯式的市场」，其产品违反商品交易法规。3 月，白宫发布了一项行政命令，要求为「降低数字资产可能对消费者、投资者和商业保护造成的风险」等目标制定相关法规。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">卡尔加里大学的法学教授 Ryan Clements 说，这些拟议条例可能无法阻止对 Indexed 的这类攻击，但可以降低或至少提醒交易者注意潜在危害。例如，法规可以规定：产品推出之前需要由具备资质的机构进行「代码审核」，并且必须实行实名注册。然而，Clements 说，这对执法将是一个挑战。政府不能像对普通网站那样「封锁」去中心化的平台，因为它们运行在全球分布的区块链上。况且，即使政府能够封锁，也可能出现模仿的平台。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">DeFi 纯粹主义者们更倾向于让政府远离他们的平台。监管网站 DeFi Watch 的负责人 Chris Blec 在推特上表示，对 Indexed 的这次攻击是「DeFi 的尴尬」，他还批评该团队向法院这样的中心化机构求助。凯勒说，他没有别的选择——DeFi 又没有自己的司法系统。无论如何，他认为 DeFi 应该在现有的法律框架内运行。「我认为，DeFi 在治理和项目管理方面应当去中心化，」他说，「但是需要一个中央机构来强制执行一些基本规则。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">在凯勒和戴提起诉讼的一周后，Medjedovic 出席了一场在 Zoom 上举行的虚拟听证会。他关掉了摄像头，并且三缄其口。法官要求他要么将本案中的争议资产转移给中立的第三方，要么在下周亲自出庭。当截止日期到达时，Medjedovic 仍然没有转移那些代币，也没有出庭。法官发出了对他的逮捕令。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">除非当局能找到 Medjedovic 或者他本人决定出庭，否则本案将一直处于悬而未决的状态.。在非加密货币案件中，如果原告获得缺席判决，法院可以简单地命令被告的银行冻结其账户或移交其资产。但由于加密钱包只有拥有私钥才能访问的特性，离开 Medjedovic 的配合，当局就无法获得代币。我问他是否已经花掉了任何攻击所得，他说，「我不相信花钱。」 最近，确实有人动了 Indexed 攻击中使用过的钱包，将价值近 40 万美元的代币转移到了一个似乎是混币器的地方，使得这些代币的去向无法追踪。这说明 Medjedovic 可能正在动用其中的一部分资金。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">几乎所有与我交谈过的人都希望他能露面，这样就算还是拿不回他们的钱，至少可以让法院解决涉及本案的棘手法律问题。Cicada 137 的律师 Bathgate 说，有「充分理由相信」 Medjedovic 已逃往国外。安大略省的执法机构表示并没有对他进行积极抓捕，而加拿大皇家骑警和 FBI 都拒绝对此发表评论。但躲起来也解决不了他的法律问题。审理此案的法官 Frederick Myers 写道：「我可以向 Andean Medjedovic 保证，诉讼并不像美酒那样，时间越久味道越好。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">说得好听一些，Medjedovic 似乎对公众的同情不感兴趣。在给我的电子邮件中，他有时坦率直言，有时明显地引战挑衅。当我问他是否背后有人给他支招的时候，他采取了后一种做法：「从头到尾，我一直私信联系我的导师 Peter Thiel。是他怂恿我这么干的！」（Thiel 的一位代表拒绝对此发表评论。）在另一些回答中，他提及了「祖先模拟」，「把钻石保存在外星」的家庭，以及一个要「从烟囱潜入别人家中，在他们的枕头下留下一本《修昔底德》」的联合国项目。至于他说的这些到底自己是否当真，即使按照互联网烂帖的标准来看，也几乎算得上怪异了。</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">对于自己的未来，Medjedovic 漠不关心，他说：「我才不关心＇找份工作＇这种事情。在笼子里摇尾巴不是我理想中的美好生活。」他没有排除创造自己的产品的可能性：「如果想到了一种必要且有用的技术，我当然会去开发出来。到目前为止，这方面我还没有获得任何神启。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">与此同时，Indexed 团队还在继续前行。今年 1 月，Indexed 推出了一个指数代币，但此后该平台的总值随着整个 DeFi 领域的衰退而进一步下降。他们计划中的升级也被搁置了。凯勒说：「这一切发生之后，我们俩都没有像原来那样的动力去继续做这个项目了。」戴补充道：「大多数人都意识到 Indexed 难以重回正轨了。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">事情也有好的一面，戴有了一只新猫咪──Katniss。而且，尽管此次攻击事件及其造成的后果令人痛苦，但它也引起了关注。凯勒和戴都收到了 DeFi 领域的工作的邀请。戴还在申请法学院。他说：「能够弥合技术与法律框架之间鸿沟的人不多，我琢磨可以自己来做。」</p><p style="white-space: normal; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us">今年 2 月，Medjedovic 还躲避在外的时候，凯勒和戴飞去参加以太坊丹佛大会。在那里他们出席了各种聚会和座谈，与一些开发者见面。但大部分时间他们俩都是在互相交谈。这是他们第一次在线下活动中见面，有太多事情要聊。为了纪念这一时刻，戴给他们俩拍了一张自拍。照片中，戴咧嘴傻笑，凯勒一脸茫然。戴将把照片发到了推特上，并配文：「理工男小队初次亮相。」</p><section style="display: flex; flex-flow: row nowrap; margin: 10px 0%; text-align: center; justify-content: center; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><section style="display: inline-block; vertical-align: top; width: auto; flex: 0 0 auto; align-self: stretch; min-width: 10%; max-width: 100%; height: auto; margin-right: 10px; margin-left: 10px; line-height: 0; box-sizing: border-box; visibility: visible; opacity: 1;"><section style="margin-right: 0%; margin-left: 0%; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><section style="font-size: 11px; color: rgb(68, 68, 68); line-height: 1; letter-spacing: 0px; box-sizing: border-box; visibility: visible; opacity: 1;"><p style="box-sizing: border-box; visibility: visible; opacity: 1;"><span style="background-color: rgb(68, 68, 68); color: rgb(255, 255, 255); box-sizing: border-box; visibility: visible; opacity: 1;"><strong style="box-sizing: border-box; visibility: visible; opacity: 1;">&nbsp;THE END&nbsp;</strong></span></p></section></section></section></section><section style="text-align: center; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><section style="max-width: 100%; vertical-align: middle; display: inline-block; line-height: 0; box-sizing: border-box; visibility: visible; opacity: 1;"><img class="rich_pages wxw-img" style="vertical-align: middle; width: 100%; box-sizing: border-box; visibility: visible; opacity: 1;" src="images/content_4.jpg"></section></section><section style="text-align: center; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><section style="max-width: 100%; vertical-align: middle; display: inline-block; line-height: 0; box-sizing: border-box; visibility: visible; opacity: 1;"><img class="rich_pages wxw-img" style="vertical-align: middle; width: 100%; box-sizing: border-box; visibility: visible; opacity: 1;" src="images/content_5.jpg"></section></section><section style="text-align: center; font-size: 13px; box-sizing: border-box; visibility: visible; opacity: 1;" powered-by="xiumi.us"><p style="box-sizing: border-box; visibility: visible; opacity: 1;">点击【阅读原文】，查看原文链接</p></section></section>
        </article>

    </div>
</body>
</html>
